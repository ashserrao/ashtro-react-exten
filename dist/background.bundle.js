(()=>{let o=[],e=null,t=!1,c=[],n=["chrome://","edge://","examroom.ai","chrome-extension://","https://testdeliveryconsole.examroom.ai/#/auth/login"];function r(o){o?chrome.storage.local.set({incognitoStatus:"Incognito is allowed"}):chrome.storage.local.set({incognitoStatus:"Incognito is not Allowed"})}function a(){return chrome.tabs.query({active:!0,currentWindow:!0},(function(o){o.length>0&&(e=o[0].id,console.log("Recorded active Tab ID: ",e))})),!0}function i(){const o="chrome-extension://".concat(chrome.runtime.id,"/recording.html");chrome.tabs.query({url:o},(function(e){e.length>0?chrome.tabs.update(e[0].id,{active:!0}):chrome.tabs.create({url:o})}))}console.log("background.js is working"),chrome.runtime.onInstalled.addListener((()=>{chrome.tabs.query({currentWindow:!0},(o=>{o.forEach((o=>{const e=o.url;n.some((o=>e.includes(o)))?chrome.tabs.reload(o.id):console.log(o.id)}))}))})),chrome.tabs.onUpdated.addListener((()=>{!0===loginStatus&&"exam-ongoing"===e_Status?chrome.tabs.query({currentWindow:!0},(o=>{o.forEach((o=>{n.some((e=>o.url.includes(e)))||console.log(o.id)}))})):console.log("Exam is not running")})),chrome.runtime.onMessage.addListener(((n,s,l)=>{"recording-page"===n.action?(a(),i(),l("page triggered")):"id-cards"===n.action||"face-capture"===n.action?(n.data.forEach((e=>{o.push(e)})),console.log(o),l("received "+("id-cards"===n.action?"ID's":"Face photo"))):"record-tab"===n.action?(a(),l("recorded-tab")):"switch-tab"===n.action?(null!==e&&chrome.tabs.update(e,{active:!0},(function(o){chrome.runtime.lastError?console.error("Error switching back to the previous tab: ",chrome.runtime.lastError):console.log("Switched back to Tab ID: ",e)})),l("switched-tab")):"check-recording-status"===n.action?l(t):"switch-recording-status"===n.action?(i(),console.log(t)):"getFlags"===n.action?c&&(l(c[0]),c.shift()):"sendFlags"===n.action?(c.push(n.data),l("Flag received.")):"content-blocked"===n.action?function(){const o="chrome-extension://".concat(chrome.runtime.id,"/contact.html");chrome.tabs.query({url:o},(function(e){e.length>0?chrome.tabs.update(e[0].id,{active:!0}):chrome.tabs.create({url:o})}))}():"check-incognito"===n.action&&chrome.extension.isAllowedIncognitoAccess().then(r)}))})();